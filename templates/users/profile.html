{% load static %}
<!doctype html>
<html lang="en">
<head>
<!-- Required meta tags -->
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<!-- favicon icon -->
<link rel="icon" href={% static "latest_ui/images/favicon.ico"%}>
<!-- Title of website -->
<title></title>
<!-- Bootstrap core CSS -->
<link href={% static "latest_ui/css/bootstrap.min.css"%} rel="stylesheet" type="text/css">
<!-- Custom Fonts CSS -->
<link href={% static "latest_ui/css/fonts.css"%} rel="stylesheet" type="text/css">
<!-- slider CSS -->
<link href={% static "latest_ui/css/owl.carousel.min.css"%} rel="stylesheet" type="text/css">
<link href={% static "latest_ui/css/owl.theme.default.min.css"%} rel="stylesheet" type="text/css">
<!-- Custom CSS -->
<link href={% static "latest_ui/css/style.css"%} rel="stylesheet" type="text/css">
<link href={% static "latest_ui/css/menu.css"%} rel="stylesheet" type="text/css">

</head>
<body>
<!-- Header -->
<header class="page-header"> 
  <!-- logoBar -->
  <div class="logoBar">
    <div class="container">
      <div class="row align-items-center">
        <aside class="col-lg-3 col-md-3 col-6"> <a href="/" class="logo" title="Bybee PC">CyberUhuruÂ </a> </aside>
        <aside class="col-lg-9 col-md-9 col-6 d-flex align-items-center justify-content-end">
          <div class="siteMenus">
            <ul>
              <li><a href="/" class="active">Home</a></li>
              <li><a href="/about">About Us</a></li>
              <li><a href="/course">Courses</a></li>
              <li><a href="/blog">Blog</a></li>
              
            </ul>

          </div>
          <ul class="becomeBtn d-none d-lg-inline-flex">
            
            <li><a href="{% url 'logout' %}">Logout</a></li>

          </ul>
        </aside>
      </div>
    </div>
  </div>
</header>
<section class="inHeader">
  <div class="pattern-layer-one"  style="background-image: url('{% static "latest_ui/images/col-bgimage-1.jpg" %}');"></div>
  <div class="container position-relative">
    <div class="row">
      <div class="col-md-12 text-center">
        <h1>Profile</h1>
        <ol class="breadcrumb">
          <li><a href="/">Home</a></li>
          <li class="active">Profile</li>
        </ol>
      </div>
    </div>
  </div>
</section>
<section class="mainProfile">
  <div class="container">
    <div class="row justify-content-between">
      <div class="col-md-3">
        <div class="sidebar">
          <ul>
            <li><a href="{% url 'profile' %}"><i class="fas fa-arrow-right"></i> Edit Profile</a></li>
            <li><a href="{% url 'candidate_certificate' %}"><i class="fas fa-arrow-right"></i> Certification</a></li>
            <li><a href="{% url 'user_change_password' %}"><i class="fas fa-arrow-right"></i> Change Password</a></li>
            <li><a href="{% url 'candidate_training' %}"><i class="fas fa-arrow-right"></i> Training</a></li>
            <li><a href="{% url 'candidate_agreement' %}"><i class="fas fa-arrow-right"></i> Agreement</a></li>
            <li><a href="{% url 'candidate_advertisement' %}"><i class="fas fa-arrow-right"></i> Advetisments</a></li>
            
          </ul>
        </div>
      </div>
      <div class="col-md-9">
        <div class="profileForm">
          <form id="profileImage" method="post" class="form" action="{% url 'profileimage' %}" role="form"
          enctype="multipart/form-data">
            {% csrf_token %}
            <div class="profileImage">
              {% if candidate_data.profile_photo %}
              <figure> <img id="profile_photo" name="profile_photo" src="{{candidate_data.profile_photo.url}}" width=135
                      height=135>
                <label for="img"> <i class="image-icon"> <span class="fas fa-camera"></span> </i> </label>
                <input id="img" type="file" accept=".jpeg, .jpg, .png" name="profile_photo" style="display:none;" />
              </figure>
              {% else %}
              <figure> <img id="profile_photo" name="profile_photo" src="{% static 'img/user2.png'%}" width=125 height=125>
                <label for="img"> <i class="image-icon"> <span class="fas fa-camera"></span>
                  <input id="img" type="file" accept=".jpeg, .jpg, .png" name="profile_photo" class='fa fa-input'
                          style="display:none;" />
                  </i> </label>
              </figure>
              {% endif %}
              <div class="loginBtn d-none" style="margin-right: 7px; justify-content: start;">
                <button type="submit" style="padding: 5px 51px 5px;" id="picButton" disabled> Upload </button>
              </div>
            </form>
            <form id="profile-form" method="post" class="form" role="form" required action="javascript:void(0)"> 
              <div class="proBar">
                  <p>60% of your profile is completed</p>
                  <div class="progress">
                    <div class="progress-bar bg-info" role="progressbar" style="width: 50%" aria-valuenow="50" aria-valuemin="0" aria-valuemax="100"></div>
                  </div>
                </div>
            </div>
            <div class="perInfo">
              <h2>Personal Information</h2>
              <div class="row">
                <div class="col-xs-6 col-md-6 form-group">
                  <label for="">First Name</label>
                  <input class="form-control" id="first_name" name="first_name" maxlength="25" placeholder="First Name"
                  type="text" value="{{candidate_data.first_name}}" style='display: text;' />
            <div class="error-messages"></div></div>
                <div class="col-xs-6 col-md-6 form-group">
                  <label for="">Last Name</label>
                  <input class="form-control" id="last_name" name="last_name" maxlength="25" placeholder="Last Name"
                  type="text" value="{{candidate_data.last_name}}" style='display: text;' />
            <div class="error-messages"></div>                </div>
              </div>
              <div class="row pt-5">
                <div class="col-xs-6 col-md-6 form-group">
                  <label for="">Email</label>
                  <input class="form-control" id="email_id" name="email_id" placeholder="Email" readonly type="email"
              value="{{candidate_data.email_id}}" style='display: text;' />
        <div class="error-messages"></div>
      </div>
                <div class="col-xs-6 col-md-6 form-group">
                  <label for="">Phone</label>
                  <input class="form-control" id="phone_number" name="phone_number" maxlength="10" minlength="10"
              placeholder="Contact No" type="number" value="{{candidate_data.phone_number}}" />
        <div class="error-messages"></div>
       </div>
              </div>
              <div class="row pt-5">
                <div class="col-md-4 form-group mb-4">
                  <label for="">Country</label>
                  <select id="country" name="country" class="form-control">
                    <option value="" disabled>Select Country*</option>
          
                    {% for country in countries %}
                    {% if candidate_address.country.id == country.id %}
                    
                <option value="{{country.id}}" selected> {{country.country}} </option>
                
                    {% else %}
                    
                <option value="{{country.id}}"> {{country.country}} </option>
                
                    {% endif %}
                    {% endfor %}
                  </select>
                </div>
                <div class="col-md-4 form-group mb-4">
                  <label for="">State</label>
                  <select  id="state" name="state" class="form-control">
                    <option value="" disabled>State*</option>
          
                    {% for state in res.data.state %}
                    {% if candidate_address.state.id == state.id %}
                    
                <option value="{{candidate_address.state.id}}" selected> {{candidate_address.state.state}} </option>
                
                    {% else %}
                    
                <option value="{{state.id}}"> {{state.state}} </option>
                
                    {% endif %}
                    {% endfor %}
                  </select>
                </div>
                <div class="col-md-4 form-group mb-4">
                  <label for="">City</label>
                  <select id="city" , name="city" class="form-control">
                    <option value="" disabled>City*</option>
          
              {% for city in res.data.cities %}
              {% if candidate_address.city.id == city.id %}
              
          <option value="{{city.id}}" selected> {{city.city}} </option>
          
              {% else %}
              
          <option value="{{city.id}}"> {{city.city}} </option>
          
              {% endif %}
              {% endfor %}
                  </select>
                  <div class="error-messages"></div>
                </div>
                <div class="col-md-6 form-group subBtn">
                  <button id="profile_submit" type="submit" name="profile_submit" class="" style="padding: 5px 51px 5px;"> Update </button>
              </div>
              </div>
            </div>
          </form>
        </div>
        <div class="eduDetail">
          <h2>{% include 'partials/_educationModal.html' %}</h2>
          <div class="table-responsive"> 
            <table id="ed_table" class="table table-striped table-hover text-center" style="font-size: 14px">
              <thead>
                <tr>
                  <th class="text-uppercase  text-xxs">Highest Qualification</th>
                  <th class="text-uppercase  text-xxs">School/Institute</th>
                  <th class="text-uppercase  text-xxs">Course Type</th>
                  <th class="text-uppercase  text-xxs">Education Type</th>
                  <th class="text-uppercase  text-xxs">Year</th>
                  <th class="text-uppercase  text-xxs">&nbsp;</th>
                </tr>
              </thead>
             
            </table>
          </div>
        </div>
        <div class="eduDetail">
          <h2> {% include 'partials/_experienceModal.html' %} </h2>
          <div class="table-responsive">
      
            <!-- <button type="button" class="btn btn-info" style="float: right;">Edit</button></br> -->
            <table class="table table-striped table-hover text-center" id="ex_table" style="font-size: 14px">
              <thead>
                <tr>
                  <th class="text-uppercase  text-xxs">Company</th>
                  <th class="text-uppercase  text-xxs">Designation</th>
                  <th class="text-uppercase  text-xxs">Curr. Working</th>
                  <th class="text-uppercase  text-xxs">Join Date</th>
                  <th class="text-uppercase  text-xxs">End Date</th>
                  <th class="text-uppercase  text-xxs">Skills</th>
                  <th class="text-uppercase  text-xxs">Description</th>
                  <th class="text-uppercase  text-xxs">&nbsp;</th>
                </tr>
              </thead>
              
            </table>
          </div>

          <div class="uplaodResume">
            <h3>Upload Resume</h3>
            <form id="upload_resume" accept=".pdf" method="post" role="form" class="form" enctype="multipart/form-data"
            action="{% url 'candidate_upload_resume' %}" onchange="return fileValidation()">
        {% csrf_token %} <br>
      
        <div class="d-flex align-items-center">
          <label for="resume">
          <img src="{% static 'img/cloud.png'%}" />
          <input type="file" name="resume" accept=".pdf, .docx, .doc" id="resume" style="display:none;" />
          <input id="viewResume" value="Select the PDF or Docx" disabled />
          {% for error in form.non_field_errors %}
          <p style="color:red;"> {{error}}</p>
          {% endfor %}
          </label>
          <button 
            id="saveResume" 
            class="btn btn-primary ms-lg-3"
            type="submit" disabled
            style="padding: 5px 51px 5px;"> Save </button>
        </div>
		
      </form>
          </div>
          <div class="uplaodResume">
            <h3>Upload Certificate</h3>
            <form id="upload_resume" accept=".pdf" method="post" role="form" class="form" enctype="multipart/form-data"
            action="{% url 'candidate_upload_resume' %}" onchange="return fileValidation()">
        {% csrf_token %} <br>
        
        <div class="d-flex align-items-center">
          <label for="resume">
          <img src="{% static 'img/cloud.png'%}" />
          <input type="file" name="resume" accept=".pdf, .docx, .doc" id="resume" style="display:none;" />
          <input id="viewResume" value="Select the PDF or Docx" disabled />
          {% for error in form.non_field_errors %}
          <p style="color:red;"> {{error}}</p>
          {% endfor %}
        </label>
          <button 
            id="saveResume" 
            class="btn btn-primary ms-lg-3"
            type="submit" disabled
            style="padding: 5px 51px 5px;"> Save </button>
        </div>
		
      </form>
          </div>
        </div>
      </div>
    </div>
  </div>
 
</section>

<footer>
  <div class="container">
    <div class="mainFoot">
    <div class="ftAbout">
      <img src={% static 'latest_ui/images/logo.png'%} alt="">
      <p>Smart and fast product to help you meet your clients' needs.</p>
      <ul class="socialMedia">
        <li><a href=""><i class="fab fa-facebook-f"></i></a></li>
        <li><a href=""><i class="fab fa-instagram"></i></a></li>
        <li><a href=""><i class="fab fa-youtube"></i></a></li>
      </ul>
    </div>
    <div class="ftMenu">
      <h5>Product</h5>
      <ul>
        <li><a href="">Solutions</a></li>
        <li><a href="">Features</a></li>
        <li><a href="">Pricing</a></li>
      </ul>
    </div>
    <div class="ftMenu">
      <h5>Company</h5>
      <ul>
        <li><a href="">About Us</a></li>
        <li><a href="">Contact Us</a></li>
      </ul>
    </div>
    <div class="ftMenu">
      <h5>Support</h5>
      <ul>
        <li><a href="">Help Center</a></li>
        <li><a href="">Developers</a></li>
      </ul>
    </div>
    <div class="ftMenu">
      <h5>Legal</h5>
      <ul>
        <li><a href="">Terms & Conditions</a></li>
        <li><a href="">Privacy policy</a></li>
      </ul>
    </div>
  </div>
  </div>
</footer>
<!-- jQuery library --> 
<script src={% static 'latest_ui/js/jquery.min.js'%} type="text/javascript"></script> 
<!-- Bootstrap core JS --> 
<script src={% static "latest_ui/js/bootstrap.min.js"%} type="text/javascript"></script> 
<script src={% static "latest_ui/js/popper.min.js"%} type="text/javascript"></script> 
<!-- jQuery for menu --> 
<script type="text/javascript" src={% static "latest_ui/js/menu.js"%}></script> 
<script type="text/javascript">
jQuery(document).ready(function($) {
jQuery('.siteMenus').stellarNav({
breakpoint:767,
position: 'right',
});
});
</script> 
<!-- slider Top --> 
<script type="text/javascript" src={% static "latest_ui/js/owl.carousel.js"%}></script> 
<script>
const actualBtn = document.getElementById('actual-btn');
const fileChosen = document.getElementById('file-chosen');
actualBtn.addEventListener('change', function(){
  fileChosen.textContent = this.files[0].name
})
</script> 
<script>
  const header = document.querySelector(".page-header");
const toggleClass = "is-sticky";

window.addEventListener("scroll", () => {
  const currentScroll = window.pageYOffset;
  if (currentScroll > 150) {
    header.classList.add(toggleClass);
  } else {
    header.classList.remove(toggleClass);
  }
});

</script>



<script>
  $("#country").on('change', function () {
    var thisObj = $(this).val();
    var token = "{{csrf_token}}";
    $.ajax({
      url: "{% url 'state' %}",
      data: {
        country_id: thisObj,
        state_id: "{{candidate_address.state.id}}"
      },
      method: "POST",
      headers: {
        "X-CSRFToken": token
      },
      success: function (res) {
        $('#state').html(res.data);
      }
    });
  });
  $("#state").ready(function () {
    var thisObj = "{{candidate_address.country.id}}";
    var token = "{{csrf_token}}";
    $.ajax({
      url: "{% url 'state' %}",
      data: {
        country_id: thisObj,
        state_id: "{{candidate_address.state.id}}"
      },
      method: "POST",
      headers: {
        "X-CSRFToken": token
      },
      success: function (res) {
        $('#state').html(res.data);
      }
    });
  });
</script> 
<script>
  $("#state").on('change', function () {
    var thisObj = $(this).val();

    var token = "{{csrf_token}}";
    $.ajax({
      url: "{% url 'city' %}",
      data: {
        state_id: thisObj,
        city_id: "{{candidate_address.city.id}}"
      },
      method: "POST",
      headers: {
        "X-CSRFToken": token
      },
      success: function (res) {
        $('#city').html(res.data);
      }
    });
  });
  $("#state").ready(function () {
    var thisObj = "{{candidate_address.state.id}}";

    var token = "{{csrf_token}}";
    $.ajax({
      url: "{% url 'city' %}",
      data: {
        state_id: thisObj,
        city_id: "{{candidate_address.city.id}}"
      },
      method: "POST",
      headers: {
        "X-CSRFToken": token
      },
      success: function (res) {
        $('#city').html(res.data);
      }
    });
  });

  // Post Method Jquery/Ajax for Profile Form
  $("#profile-form").submit(function () {
    var form = document.getElementById('profile-form')
    var token = "{{csrf_token}}";
    var formData = new FormData(form);
    var fromObj = $("#profile-form");
    var url = "{% url 'profile' %}";

    $.ajax({
      url: url,
      method: "POST",
      dataType: "JSON",
      data: formData,
      contentType: false,
      processData: false,
      headers: {
        "X-CSRFToken": token
      },
      beforeSend: function () {
        fromObj.find(".error-message").remove();
      },
      success: function (res) {
        if (res.status) {
          $(".error-messages").hide()
          $(".form-control").css({
            border: "0px"
          })
          // alert('Your Information updated successFully!')
          fromObj.find("#pi-error-msg")
            .html("Your Information updated successFully!")
            .css({'color': 'green', 'font-size': '14px', 'text-align': 'center'})
          setTimeout(function(){ 
            fromObj.find("#pi-error-msg").html('')
           }, 3000);
        } else if (!$.isEmptyObject(res.errors)) {
          $.each(res.errors, function (i, v) {
            fromObj.find('input[name=' + i + ']').siblings("div").html(v.join(','));
            fromObj
              .find("input[name=" + i + "]")
              .css({
                border: "1px solid red"
              });
            fromObj
              .find("input[name=" + i + "]")
              .siblings("div")
              .css({
                'color': 'red',
                'font-size': '10px'
              });
          });
        } else {
          console.log("Something Went wrong in Profile update ")
        }
      }
    })
  })
</script> 
<script>
  // Jquery/Ajax to Get employment history
  $("#experience").ready(function () {
    var token = "{{csrf_token}}";
    $.ajax({
      url: "{% url 'candidate_employment_history' %}",
      method: "GET",
      success: function (res) {
        data = JSON.parse(res.data)
        // $("#experience").html();
        for (i = 0; i < data.length; i++) {
          var row = $('<tr>' +
            '<td><input type="radio" name="mySelection" class="experience_class" onclick="openEdit()" value=' +
            data[i].pk + '>&nbsp;' + '</td>' +
            '<td>' + data[i].fields.company_name + '</td>' +
            '<td>' + data[i].fields.designation + '</td>' +
            '<td>' + data[i].fields.currently_working + '</td>' +
            '<td>' + new Date(data[i].fields.joining_date).toLocaleDateString('es-CL') + '</td>' +
            '<td>' + new Date(data[i].fields.end_date).toLocaleDateString('es-CL') + '</td>' +
            '<td>' + data[i].fields.skills + '</td>' +
            '<td>' + data[i].fields.description + '</td>' +
            '</tr>'
          );
          $('#ex_table').append(row);
        }
      },
    })
  })



  $("#education").ready(function () {
    var token = "{{csrf_token}}";
    $.ajax({
      url: "{% url 'candidate_education_details' %}",
      method: "GET",
      success: function (res) {
        data = JSON.parse(res.data)
        for (i = 0; i < res.highest_qualification_choices.length; i++) {
          $('#highest_qualification')
            .append($('<option>')
              .val(res.highest_qualification_choices[i][0])
              .text(res.highest_qualification_choices[i][1]));
        }
        for (i = 0; i < res.course_type_choices.length; i++) {
          $('#course_type')
            .append($('<option>')
              .val(res.course_type_choices[i][0])
              .text(res.course_type_choices[i][1]));
        }
        for (i = 0; i < res.passing_out_year_choices.length; i++) {
          $('#passing_out_year')
            .append($('<option>')
              .val(res.passing_out_year_choices[i][0])
              .text(res.passing_out_year_choices[i][1]));
        }
        for (i = 0; i < res.education_type_choices.length; i++) {
          $('#education_type')
            .append($('<option>')
              .val(res.education_type_choices[i][0])
              .text(res.education_type_choices[i][1]));
        }
        for (i = 0; i < data.length; i++) {

          var row = $('<tr>' +
            '<td><input type="radio" class="education_class" name="myEdSelection" onclick="educationEdit()" value=' +
            data[i].pk + '>&nbsp;' + '</td>' +
            '<td>' + data[i].fields.highest_qualification + '</td>' +
            '<td>' + data[i].fields.institute + '</td>' +
            '<td>' + data[i].fields.course_type + '</td>' +
            '<td>' + data[i].fields.education_type + '</td>' +
            '<td>' + data[i].fields.passing_out_year + '</td>' +
            '</tr>'
          );
          $('#ed_table').append(row);
        }
      },
    });
  });

  $("#file").ready(function () {

    var token = "{{csrf_token}}";
    $.ajax({
      url: "{% url 'candidate_display_resume' %}",
      method: "GET",
      headers: {
        "X-CSRFToken": token
      },
      success: function (res) {
        if (res.errors) {
          $('#file').html('No File Uploaded yet');
        }
        if (res.resume) {
          $('#file').html(res.resume);
          document.querySelector("#file").setAttribute("href", res.resume)
          document.querySelector("#file").innerHTML = res.resume_name
        }
      }
    });
  });
</script> 
<script>
  function fileValidation() {
    var fileInput = document.getElementById('resume');

    var filePath = fileInput.value;

    // Allowing file type
    var allowedExtensions =
      /(\.doc|\.docx|\.odt|\.pdf|\.tex|\.txt|\.rtf|\.wps|\.wks|\.wpd)$/i;

    if (!allowedExtensions.exec(filePath)) {
      alert('Please select only pdf file!');
      fileInput.value = '';
      return false;
    }
  }
</script> 
<script>
  // Profile Image Preview
  var profilePic = document.querySelector("#profile_photo");
  var img = document.querySelector("#img");
  img.addEventListener("change", (event) => {
    var picURL = window.URL.createObjectURL(event.target.files[0]);
    document.querySelector("#profile_photo").src = picURL
    document.querySelector("#picButton").removeAttribute("disabled")
  });
</script> 
<script>
  //  PDF name View
  $("#resume").change(function () {
    var value = $("#resume").val()
    var splits = value.split("fakepath\\")
    $("#viewResume").val(splits[1])
    $("#saveResume").prop("disabled", false)
  })
</script> 
<script>
  function openEdit() {

    document.getElementById("experience_edit").disabled = false;
  };

  $("#experience_edit").click(function () {
    var radio = document.getElementsByName("mySelection"); //Client ID of the radiolist
    var selected;

    for (var i = 0; i < radio.length; i++) {
      if (radio[i].checked) {
        selected = radio[i];
        break;
      }
    }
    var modalDiv = $("#modal-div");
    var token = "{{csrf_token}}";
    var url = "{% url 'candidate_employment_history' %}" + "?id=" + selected.value
    $.ajax({
      url: url,
      method: "GET",
      headers: {
        "X-CSRFToken": token
      },
      success: function (res) {
        $('#company_name').val(res.data['company_name']);
        $('#designation').val(res.data['designation']);
        $('#currently_working').prop('checked', res.data['currently_working']);
        $('#skills').val(res.data['skills']);
        j_date = new Date(res.data['joining_date'])
        e_date = new Date(res.data['end_date'])
        $('#joining_date').val(j_date.toISOString().substr(0, 10));
        $('#end_date').val(e_date.toISOString().substr(0, 10));
        $('textarea#description').html(res.data['description']);

      }
    })
  })
</script> 
<script>
  $("#experience-form").submit(function () {
    function postAPI(type, url, formData, fromObj) {
      $.ajax({
        url: experience_url,
        method: "POST",
        dataType: "JSON",
        data: formData,
        contentType: false,
        processData: false,
        headers: {
          "X-CSRFToken": token
        },

        success: function (res) {

          if (res.success == true) {
            $('#experience-form').trigger("reset");
            location.href = "{% url 'profile' %}"
          } else if (!$.isEmptyObject(res.errors)) {
            $.each(res.errors, function (i, v) {
              fromObj.find('input[name=' + i + ']').siblings("div").html(v.join(','));
              fromObj
                .find("input[name=" + i + "]")
                .css({
                  border: "1px solid red"
                });
              fromObj
                .find("input[name=" + i + "]")
                .siblings("div")
                .css({
                  'color': 'red',
                  'font-size': '10px'
                });
            });
          } else {
            console.log("Something Went wrong in Experience update ")
          }
        },
      });
    }

    var experience_url = "{% url 'candidate_employment_history' %}"
    var form = document.getElementById('experience-form')
    var token = "{{csrf_token}}";
    var formData = new FormData(form);
    var formObj = $("#experience-form");
    var radio = document.getElementsByName("mySelection"); //Client ID of the radiolist
    var selected;

    for (var i = 0; i < radio.length; i++) {
      if (radio[i].checked) {
        selected = radio[i];
        break;
      }
    }
    if (selected) {
      experience_url = experience_url + "?id=" + selected.value
    }

    postAPI("candidate_employment_history", experience_url, formData, formObj);
  });
</script> 
<script>
  function educationEdit() {

    document.getElementById("education_edit").disabled = false;
  };

  //  On click of Education edit Button
  $("#education_edit").click(function () {
    var radio = document.getElementsByName("myEdSelection"); //Client ID of the radiolist
    var selected;

    for (var i = 0; i < radio.length; i++) {
      if (radio[i].checked) {
        selected = radio[i];
        break;
      }
    }

    var token = "{{csrf_token}}";
    var url = "{% url 'candidate_education_details' %}" + "?id=" + selected.value
    $.ajax({
      url: url,
      method: "GET",
      headers: {
        "X-CSRFToken": token
      },
      success: function (res) {
        $('#institute').val(res.data['institute']);
        $('#highest_qualification').val(res.data['highest_qualification']).attr("selected", "selected");
        $('#course_type').val(res.data['course_type']).attr("selected", "selected");
        $('#passing_out_year').val(res.data['passing_out_year']).attr("selected", "selected");
        $('#education_type').val(res.data['education_type']).attr("selected", "selected");

      }
    })
  })
</script> 
<script>
  //  Submit Form for Education 
  $("#education-form").submit(function () {
    function postAPI(type, url, formData, fromObj) {
      $.ajax({
        url: url,
        method: "POST",
        dataType: "JSON",
        data: formData,
        contentType: false,
        processData: false,
        headers: {
          "X-CSRFToken": token
        },

        success: function (res) {

          if (res.success == true) {
            $('#education-form').trigger("reset");
            location.href = "{% url 'profile' %}"
          } else if (!$.isEmptyObject(res.errors)) {
            $.each(res.errors, function (i, v) {
              fromObj.find('input[name=' + i + ']').siblings("div").html(v.join(','));
              fromObj
                .find("input[name=" + i + "]")
                .css({
                  border: "1px solid red"
                });
              fromObj
                .find("input[name=" + i + "]")
                .siblings("div")
                .css({
                  'color': 'red',
                  'font-size': '10px'
                });
            });
          } else {
            console.log("Something Went wrong in Experience update ")
          }
        },
      });
    }

    var education_url = "{% url 'candidate_education_details' %}"
    var form = document.getElementById('education-form')
    var token = "{{csrf_token}}";
    var formData = new FormData(form);
    var formObj = $("#education-form");
    var radio = document.getElementsByName("myEdSelection"); //Client ID of the radiolist
    var selected;

    for (var i = 0; i < radio.length; i++) {
      if (radio[i].checked) {
        selected = radio[i];
        break;
      }
    }
    if (selected) {
      education_url = education_url + "?id=" + selected.value
    }
    postAPI("candidate_education_details", education_url, formData, formObj);
  });
</script> 
<script>
  //  Event to reset the form after edit close and go on Add For Education
  $("#education_add").click(function () {
    $('#education-form').trigger("reset");
    $('.education_class').prop('checked', false);
    document.getElementById("education_edit").disabled = true;
    $('#highest_qualification').val("").attr("selected", "selected");
    $('#course_type').val("").attr("selected", "selected");
    $('#passing_out_year').val("").attr("selected", "selected");
    $('#education_type').val("").attr("selected", "selected");
    $('#modalEducationForm').modal('show');
  });

  //  Event to reset the form after edit close and go on Add For Experience
  $("#experience_add").click(function () {
    $('#experience-form').trigger("reset");
    $('#description').val('');
    $('.experience_class').prop('checked', false);
    document.getElementById("experience_edit").disabled = true;
    $('#modalExperineceForm').modal('show');
  })
</script>

</body>
</html>
